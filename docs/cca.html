<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pl" xml:lang="pl"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Analiza kanoniczna â€“ Wielowymiarowa analiza danych</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./fa.html" rel="next">
<link href="./multi_tests.html" rel="prev">
<link href="./images/cover.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-b758ccaa5987ceb1b75504551e579abf.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-6b8c1b7f874bdd152064db223e7d36ae.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-7becdd8e1b79f26ea566d6ea537c1a09.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-6b8c1b7f874bdd152064db223e7d36ae.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Brak wynikÃ³w",
    "search-matching-documents-text": "dopasowane dokumenty",
    "search-copy-link-title": "Kopiuj link do wyszukiwania",
    "search-hide-matches-text": "Ukryj dodatkowe dopasowania",
    "search-more-match-text": "wiÄ™cej dopasowaÅ„ w tym dokumencie",
    "search-more-matches-text": "wiÄ™cej dopasowaÅ„ w tym dokumencie",
    "search-clear-button-title": "WyczyÅ›Ä‡",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Anuluj",
    "search-submit-button-title": "ZatwierdÅº",
    "search-label": "Szukaj"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating slimcontent quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="PrzeÅ‚Ä…cz pasek boczny" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./cca.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Analiza kanoniczna</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="PrzeÅ‚Ä…cz pasek boczny" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Szukaj" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./images/logo.jpg" alt="" class="sidebar-logo light-content py-0 d-lg-inline d-none"><img src="./images/logo.jpg" alt="" class="sidebar-logo dark-content py-0 d-lg-inline d-none"></a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Wielowymiarowa analiza danych</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/DariuszMajerek/WAD_new" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="https://twitter.com/intent/tweet?url=%7Curl%7C" title="Twitter" class="quarto-navigation-tool px-1" aria-label="Twitter"><i class="bi bi-twitter"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="PrzeÅ‚Ä…cz tryb ciemny"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="PrzeÅ‚Ä…cz tryb czytnika">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Szukaj"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">WstÄ™p</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multi_tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Testy wielowymiarowe</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cca.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Analiza kanoniczna</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Analiza czynnikowa</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Modele strukturalne</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Metody redukcji wymiarowoÅ›ci</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Analiza skupieÅ„</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./correspondence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Analiza korespondencji</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./loglinear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Modele log-liniowe</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Literatura</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Spis treÅ›ci</h2>
   
  <ul>
<li><a href="#przypomnienie-z-algebry" id="toc-przypomnienie-z-algebry" class="nav-link active" data-scroll-target="#przypomnienie-z-algebry">Przypomnienie z algebry ğŸ˜‰</a></li>
  <li><a href="#definicja-modelu" id="toc-definicja-modelu" class="nav-link" data-scroll-target="#definicja-modelu">Definicja modelu</a></li>
  <li>
<a href="#dow%C3%B3d-istnienia-rozwi%C4%85zania" id="toc-dowÃ³d-istnienia-rozwiÄ…zania" class="nav-link" data-scroll-target="#dow%C3%B3d-istnienia-rozwi%C4%85zania">DowÃ³d istnienia rozwiÄ…zania</a>
  <ul class="collapse">
<li><a href="#sformu%C5%82owanie-problemu-w%C5%82asnego" id="toc-sformuÅ‚owanie-problemu-wÅ‚asnego" class="nav-link" data-scroll-target="#sformu%C5%82owanie-problemu-w%C5%82asnego">SformuÅ‚owanie problemu wÅ‚asnego</a></li>
  <li><a href="#w%C5%82asno%C5%9Bci-rozwi%C4%85za%C5%84" id="toc-wÅ‚asnoÅ›ci-rozwiÄ…zaÅ„" class="nav-link" data-scroll-target="#w%C5%82asno%C5%9Bci-rozwi%C4%85za%C5%84">WÅ‚asnoÅ›ci rozwiÄ…zaÅ„</a></li>
  </ul>
</li>
  <li>
<a href="#testowanie-liczby-istotnych-korelacji-kanonicznych" id="toc-testowanie-liczby-istotnych-korelacji-kanonicznych" class="nav-link" data-scroll-target="#testowanie-liczby-istotnych-korelacji-kanonicznych">Testowanie liczby istotnych korelacji kanonicznych</a>
  <ul class="collapse">
<li><a href="#hipoteza-zerowa-i-alternatywna" id="toc-hipoteza-zerowa-i-alternatywna" class="nav-link" data-scroll-target="#hipoteza-zerowa-i-alternatywna">Hipoteza zerowa i alternatywna</a></li>
  <li><a href="#statystyka-testowa-test-wilka" id="toc-statystyka-testowa-test-wilka" class="nav-link" data-scroll-target="#statystyka-testowa-test-wilka">Statystyka testowa â€“ test Wilka</a></li>
  <li><a href="#rozk%C5%82ad-asymptotyczny-i-transformacja-do-rozk%C5%82adu-chi2" id="toc-rozkÅ‚ad-asymptotyczny-i-transformacja-do-rozkÅ‚adu-chi2" class="nav-link" data-scroll-target="#rozk%C5%82ad-asymptotyczny-i-transformacja-do-rozk%C5%82adu-chi2">RozkÅ‚ad asymptotyczny i transformacja do rozkÅ‚adu <span class="math inline">\(\chi^2\)</span></a></li>
  <li><a href="#procedura-testowania" id="toc-procedura-testowania" class="nav-link" data-scroll-target="#procedura-testowania">Procedura testowania</a></li>
  </ul>
</li>
  <li>
<a href="#ocena-dopasowania-modelu" id="toc-ocena-dopasowania-modelu" class="nav-link" data-scroll-target="#ocena-dopasowania-modelu">Ocena dopasowania modelu</a>
  <ul class="collapse">
<li><a href="#%C5%82adunki-czynnikowe-ang.-canonical-loadings" id="toc-Å‚adunki-czynnikowe-ang.-canonical-loadings" class="nav-link" data-scroll-target="#%C5%82adunki-czynnikowe-ang.-canonical-loadings">Åadunki czynnikowe (ang. <em>canonical loadings</em>)</a></li>
  <li><a href="#wariancja-wyja%C5%9Bniona-ang.-variance-explained" id="toc-wariancja-wyjaÅ›niona-ang.-variance-explained" class="nav-link" data-scroll-target="#wariancja-wyja%C5%9Bniona-ang.-variance-explained">Wariancja wyjaÅ›niona (ang. <em>variance explained</em>)</a></li>
  <li><a href="#redundancja-ang.-redundancy-index" id="toc-redundancja-ang.-redundancy-index" class="nav-link" data-scroll-target="#redundancja-ang.-redundancy-index">Redundancja (ang. <em>redundancy index</em>)</a></li>
  </ul>
</li>
  <li>
<a href="#za%C5%82o%C5%BCenia-stosowalno%C5%9Bci-analizy-kanonicznej" id="toc-zaÅ‚oÅ¼enia-stosowalnoÅ›ci-analizy-kanonicznej" class="nav-link" data-scroll-target="#za%C5%82o%C5%BCenia-stosowalno%C5%9Bci-analizy-kanonicznej">ZaÅ‚oÅ¼enia stosowalnoÅ›ci analizy kanonicznej</a>
  <ul class="collapse">
<li><a href="#normalno%C5%9B%C4%87-wielowymiarowa" id="toc-normalnoÅ›Ä‡-wielowymiarowa" class="nav-link" data-scroll-target="#normalno%C5%9B%C4%87-wielowymiarowa">NormalnoÅ›Ä‡ wielowymiarowa</a></li>
  <li><a href="#brak-warto%C5%9Bci-odstaj%C4%85cych-outliers" id="toc-brak-wartoÅ›ci-odstajÄ…cych-outliers" class="nav-link" data-scroll-target="#brak-warto%C5%9Bci-odstaj%C4%85cych-outliers">Brak wartoÅ›ci odstajÄ…cych (outliers)</a></li>
  <li><a href="#wystarczaj%C4%85ca-liczba-obserwacji" id="toc-wystarczajÄ…ca-liczba-obserwacji" class="nav-link" data-scroll-target="#wystarczaj%C4%85ca-liczba-obserwacji">WystarczajÄ…ca liczba obserwacji</a></li>
  <li><a href="#liniowo%C5%9B%C4%87-zale%C5%BCno%C5%9Bci" id="toc-liniowoÅ›Ä‡-zaleÅ¼noÅ›ci" class="nav-link" data-scroll-target="#liniowo%C5%9B%C4%87-zale%C5%BCno%C5%9Bci">LiniowoÅ›Ä‡ zaleÅ¼noÅ›ci</a></li>
  <li><a href="#brak-nadmiernej-wsp%C3%B3%C5%82liniowo%C5%9Bci-multikolinearno%C5%9Bci" id="toc-brak-nadmiernej-wspÃ³Å‚liniowoÅ›ci-multikolinearnoÅ›ci" class="nav-link" data-scroll-target="#brak-nadmiernej-wsp%C3%B3%C5%82liniowo%C5%9Bci-multikolinearno%C5%9Bci">Brak nadmiernej wspÃ³Å‚liniowoÅ›ci (multikolinearnoÅ›ci)</a></li>
  <li><a href="#niezale%C5%BCno%C5%9B%C4%87-obserwacji" id="toc-niezaleÅ¼noÅ›Ä‡-obserwacji" class="nav-link" data-scroll-target="#niezale%C5%BCno%C5%9B%C4%87-obserwacji">NiezaleÅ¼noÅ›Ä‡ obserwacji</a></li>
  </ul>
</li>
  <li><a href="#implementacje-cca-w-r" id="toc-implementacje-cca-w-r" class="nav-link" data-scroll-target="#implementacje-cca-w-r">Implementacje CCA w R</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/DariuszMajerek/WAD_new/issues/new" class="toc-action"><i class="bi bi-github"></i>ZgÅ‚oÅ› problem</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span class="chapter-title">Analiza kanoniczna</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>Analiza kanoniczna (ang. <em>Canonical Correlation Analysis, CCA</em>) jest klasycznÄ… technikÄ… statystycznÄ… sÅ‚uÅ¼Ä…cÄ… do badania zwiÄ…zkÃ³w pomiÄ™dzy dwoma zestawami zmiennych wielowymiarowych. Jej podstawowym celem jest znalezienie takich kombinacji liniowych zmiennych z obu zestawÃ³w, ktÃ³re maksymalizujÄ… wzajemnÄ… korelacjÄ™ â€“ sÄ… to tzw. kanoniczne zmienne lub kanoniczne skÅ‚adniki. Technika ta zostaÅ‚a wprowadzona przez Harolda Hotellinga w roku 1936, a wiÄ™c w okresie intensywnego rozwoju metod statystycznych opartych na algebrze macierzy <span class="citation" data-cites="hotelling1936">(<a href="references.html#ref-hotelling1936" role="doc-biblioref">Hotelling 1936</a>)</span>.</p>

<div class="no-row-height column-margin column-container"><div class="">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="images/hotelling.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Harold Hotelling"><img src="images/hotelling.jpg" class="img-fluid figure-img" alt="Harold Hotelling"></a></p>
<figcaption>Harold Hotelling</figcaption></figure>
</div>
</div><div id="fn1"><p><sup>1</sup>&nbsp;o ktÃ³rych juÅ¼ wkrÃ³tce</p></div></div><p>W tym samym czasie powstawaÅ‚y takÅ¼e inne fundamenty analizy wielowymiarowej, takie jak analiza skÅ‚adowych gÅ‚Ã³wnych (PCA) czy dyskryminacja liniowa (LDA)<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. Analiza kanoniczna stanowi zatem jeden z filarÃ³w klasycznej statystyki wielowymiarowej i do dziÅ› pozostaje istotnym narzÄ™dziem eksploracji i modelowania zÅ‚oÅ¼onych zaleÅ¼noÅ›ci.</p>
<p>W odrÃ³Å¼nieniu od regresji wielorakiej, ktÃ³ra przewiduje zestaw zmiennych zaleÅ¼nych na podstawie zestawu predyktorÃ³w, analiza kanoniczna traktuje obie grupy zmiennych symetrycznie â€“ nie zakÅ‚ada istnienia wyraÅºnego kierunku przyczynowego. Dlatego stosuje siÄ™ jÄ… w sytuacjach, gdy celem jest ogÃ³lna analiza wspÃ³Å‚zaleÅ¼noÅ›ci pomiÄ™dzy dwoma zbiorami zmiennych, a nie przewidywanie jednego zestawu na podstawie drugiego.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="images/cca.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="PrzykÅ‚adowy model analizy kanonicznej"><img src="images/cca.png" class="img-fluid figure-img" width="500" alt="PrzykÅ‚adowy model analizy kanonicznej"></a></p>
<figcaption>PrzykÅ‚adowy model analizy kanonicznej</figcaption></figure>
</div>
<p>Typowe zastosowania analizy kanonicznej obejmujÄ…:</p>
<ul>
<li>
<p>Psychologia i nauki spoÅ‚eczne â€“ badanie relacji miÄ™dzy grupami testÃ³w poznawczych a zmiennymi demograficznymi.</p>
<p><em>PrzykÅ‚ad:</em> W badaniu dzieci w wieku szkolnym mierzy siÄ™ wyniki w testach: pamiÄ™ci, uwagi i szybkoÅ›ci przetwarzania informacji (zmienne poznawcze), a nastÄ™pnie porÃ³wnuje siÄ™ je z takimi cechami, jak wiek, poziom wyksztaÅ‚cenia rodzicÃ³w oraz status spoÅ‚eczno-ekonomiczny (zmienne demograficzne). Analiza kanoniczna pozwala oceniÄ‡, ktÃ³re kombinacje cech demograficznych sÄ… powiÄ…zane z ogÃ³lnym wzorcem zdolnoÅ›ci poznawczych.,</p>
</li>
<li>
<p>Biologia i medycyna â€“ analiza zaleÅ¼noÅ›ci pomiÄ™dzy pomiarami fizjologicznymi (np. poziomy hormonÃ³w) a cechami klinicznymi (np. objawy choroby).</p>
<p><em>PrzykÅ‚ad:</em> W grupie pacjentÃ³w z depresjÄ… mierzy siÄ™ poziomy kortyzolu, serotoniny i dopaminy (wskaÅºniki biologiczne), a takÅ¼e nasilenie objawÃ³w takich jak bezsennoÅ›Ä‡, brak apetytu, spadek energii czy anhedonia<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> (zmienne kliniczne). Analiza kanoniczna pomaga zidentyfikowaÄ‡ wspÃ³lnÄ… strukturÄ™ zmiennoÅ›ci â€“ np. czy okreÅ›lony wzorzec hormonalny odpowiada za okreÅ›lony profil objawÃ³w.</p>
</li>
<li>
<p>Ekonomia â€“ porÃ³wnywanie zestawÃ³w wskaÅºnikÃ³w ekonomicznych z rÃ³Å¼nych dziedzin (np. zmienne finansowe vs.&nbsp;konsumpcyjne).</p>
<p><em>PrzykÅ‚ad:</em> W badaniu krajÃ³w Unii Europejskiej zestawia siÄ™ wskaÅºniki makroekonomiczne, takie jak stopa inflacji, stopa bezrobocia i zadÅ‚uÅ¼enie publiczne (zmienne finansowe), z danymi dotyczÄ…cymi konsumpcji â€“ np. wydatki na kulturÄ™, transport i Å¼ywnoÅ›Ä‡ (zmienne konsumpcyjne). Analiza kanoniczna umoÅ¼liwia odkrycie wspÃ³lnych ukÅ‚adÃ³w zaleÅ¼noÅ›ci miÄ™dzy stabilnoÅ›ciÄ… finansowÄ… a wzorcami konsumpcji.</p>
</li>
<li>
<p>Lingwistyka korpusowa â€“ badania zbieÅ¼noÅ›ci struktur gramatycznych i semantycznych.</p>
<p><em>PrzykÅ‚ad:</em> W analizie duÅ¼ego korpusu tekstÃ³w (np. esejÃ³w studentÃ³w lub wypowiedzi politykÃ³w) zestawia siÄ™ cechy skÅ‚adniowe, takie jak dÅ‚ugoÅ›Ä‡ zdaÅ„, liczba zdaÅ„ podrzÄ™dnie zÅ‚oÅ¼onych, liczba czasownikÃ³w (zmienne skÅ‚adniowe), z cechami semantycznymi takimi jak stopieÅ„ abstrakcyjnoÅ›ci uÅ¼ywanych rzeczownikÃ³w, nacechowanie emocjonalne sÅ‚ownictwa czy liczba metafor (zmienne semantyczne). CCA pozwala oceniÄ‡, czy bardziej zÅ‚oÅ¼ona skÅ‚adnia idzie w parze z wiÄ™kszÄ… abstrakcyjnoÅ›ciÄ… przekazu.</p>
</li>
<li>
<p>Genomika i bioinformatyka â€“ integracja danych z rÃ³Å¼nych platform pomiarowych (np. ekspresji genÃ³w i metylacji DNA<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>).</p>
<p><em>PrzykÅ‚ad:</em> Dla prÃ³bek guza nowotworowego analizuje siÄ™ jednoczeÅ›nie poziomy ekspresji genÃ³w (np. z RNA) i poziomy metylacji DNA (z mikromacierzy EPIC). CCA pozwala odnaleÅºÄ‡ kanoniczne kombinacje genÃ³w i regionÃ³w metylacyjnych, ktÃ³re sÄ… wspÃ³Å‚zmienne i mogÄ… byÄ‡ zwiÄ…zane z podtypem nowotworu lub odpowiedziÄ… na leczenie.</p>
</li>
</ul>
<div class="no-row-height column-margin column-container"><div id="fn2"><p><sup>2</sup>&nbsp;termin stosowany w psychologii i psychiatrii, ktÃ³ry oznacza utraconÄ… zdolnoÅ›Ä‡ do odczuwania przyjemnoÅ›ci z czynnoÅ›ci, ktÃ³re wczeÅ›niej byÅ‚y ÅºrÃ³dÅ‚em satysfakcji, radoÅ›ci lub zainteresowania</p></div><div id="fn3"><p><sup>3</sup>&nbsp;polega na chemicznym doÅ‚Ä…czaniu grupy metylowej (â€“CH<sub>3</sub>)</p></div></div><section id="przypomnienie-z-algebry" class="level1 page-columns page-full"><h1>Przypomnienie z algebry ğŸ˜‰</h1>
<p>Na potrzeby definicji modeli kanonicznego potrzebne bÄ™dÄ… nam pewne twierdzenia z zakresu algebry.</p>
<div id="lem-1" class="lem theorem lemma page-columns page-full">
<p><span class="theorem-title"><strong>Lemat 3.1 (NierÃ³wnoÅ›Ä‡ <strong>Cauchyâ€™egoâ€“Schwarza</strong><a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>)</strong></span> Niech <span class="math inline">\(a,b\)</span> bÄ™dÄ… dwoma wektorami kolumnowymi o wymiarach <span class="math inline">\(p\times 1\)</span>, wÃ³wczas</p>
<div class="no-row-height column-margin column-container"><div id="fn4"><p><sup>4</sup>&nbsp;znanej rÃ³wnieÅ¼ jako Cauchyâ€™egoâ€“Buniakowskiegoâ€“Schwarzaâ€“BienaymÃ©</p></div></div><p><span class="math display">\[
(a^\top b)\leq (a^\top a)(b^\top b).
\]</span></p>
<p>PowyÅ¼sza nierÃ³wnoÅ›Ä‡ staje siÄ™ rÃ³wnoÅ›ciÄ… jeÅ›li <span class="math inline">\(b=\lambda \cdot a\)</span>, dla pewnej staÅ‚ej <span class="math inline">\(\lambda\)</span>.</p>
</div>
<div id="lem-2" class="lem theorem lemma page-columns page-full">
<p><span class="theorem-title"><strong>Lemat 3.2 (Twierdzenie o maksymalizacji formy kwadratowej<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>)</strong></span> Niech <span class="math inline">\(\mathbf{B} \in \mathbb{R}^{p \times p}\)</span> bÄ™dzie symetrycznÄ…, dodatnio okreÅ›lonÄ… macierzÄ…, o uporzÄ…dkowanych malejÄ…co wartoÅ›ciach wÅ‚asnych <span class="math inline">\(\lambda_1 \geq \lambda_2 \geq \cdots \geq \lambda_p &gt; 0\)</span> oraz odpowiadajÄ…cych im ortonormalnych wektorach wÅ‚asnych <span class="math inline">\(\boldsymbol{e}_1, \boldsymbol{e}_2, \ldots, \boldsymbol{e}_p\)</span>. WÃ³wczas:</p>
<div class="no-row-height column-margin column-container"><div id="fn5"><p><sup>5</sup>&nbsp;znane rÃ³wnieÅ¼ jako lemat Rayleigha-Ritza</p></div></div><ol type="1">
<li><p><strong>Maksymalna wartoÅ›Ä‡ ilorazu Rayleigha</strong> dla wszystkich niezerowych wektorÃ³w <span class="math inline">\(\boldsymbol{x} \in \mathbb{R}^p\)</span>: <span class="math display">\[
\max_{\boldsymbol{x} \neq \boldsymbol{0}} \frac{\boldsymbol{x}^\top \mathbf{B} \boldsymbol{x}}{\boldsymbol{x}^\top \boldsymbol{x}} = \lambda_1,
\]</span> i jest osiÄ…gana dla <span class="math inline">\(\boldsymbol{x} = \boldsymbol{e}_1\)</span>, czyli wektora wÅ‚asnego odpowiadajÄ…cego najwiÄ™kszej wartoÅ›ci wÅ‚asnej.</p></li>
<li><p><strong>Minimalna wartoÅ›Ä‡ ilorazu Rayleigha</strong>:</p></li>
</ol>
<p><span class="math display">\[
\min_{\boldsymbol{x} \neq \boldsymbol{0}} \frac{\boldsymbol{x}^\top \mathbf{B} \boldsymbol{x}}{\boldsymbol{x}^\top \boldsymbol{x}} = \lambda_p,
\]</span> i jest osiÄ…gana dla <span class="math inline">\(\boldsymbol{x} = \boldsymbol{e}_p\)</span>, czyli wektora wÅ‚asnego odpowiadajÄ…cego najmniejszej wartoÅ›ci wÅ‚asnej.</p>
<ol start="3" type="1">
<li>
<strong>Ograniczona maksymalizacja w podprzestrzeni ortogonalnej do</strong> <span class="math inline">\(\boldsymbol{e}_1, \ldots, \boldsymbol{e}_k\)</span>:</li>
</ol>
<p>JeÅ›li maksymalizacja jest prowadzona pod warunkiem ortogonalnoÅ›ci <span class="math inline">\(\boldsymbol{x} \perp \boldsymbol{e}_1, \ldots, \boldsymbol{e}_k\)</span>, wÃ³wczas: <span class="math display">\[
\max_{\boldsymbol{x} \perp \boldsymbol{e}_1, \ldots, \boldsymbol{e}_k} \frac{\boldsymbol{x}^\top \mathbf{B} \boldsymbol{x}}{\boldsymbol{x}^\top \boldsymbol{x}} = \lambda_{k+1},
\]</span> i maksimum osiÄ…gane jest dla <span class="math inline">\(\boldsymbol{x} = \boldsymbol{e}_{k+1}\)</span>.</p>
<p>Twierdzenie to formalizuje intuicjÄ™, Å¼e <strong>wartoÅ›ci wÅ‚asne</strong> macierzy symetrycznej reprezentujÄ… <strong>ekstremalne wartoÅ›ci formy kwadratowej</strong> w kierunkach okreÅ›lonych przez wektory wÅ‚asne.</p>
</div>
<p>Oto <strong>matematyczna definicja modelu CCA</strong> oraz <strong>dowÃ³d istnienia rozwiÄ…zania</strong>, sformuÅ‚owana Å›ciÅ›le w duchu Twojego tekstu:</p>
</section><section id="definicja-modelu" class="level1"><h1>Definicja modelu</h1>
<p>Niech <span id="eq-normal"><span class="math display">\[
\begin{pmatrix}
X\\
Y
\end{pmatrix}
\sim
\mathcal{N}_{p+q}\left(
\begin{pmatrix}
\mu \\
\nu
\end{pmatrix},
\begin{pmatrix}
\Sigma_{XX} &amp; \Sigma_{XY}\\
\Sigma_{YX} &amp; \Sigma_{YY}
\end{pmatrix}
\right)
\tag{4.1}\]</span></span></p>
<p>gdzie:</p>
<ul>
<li>
<span class="math inline">\(X \in \mathbb{R}^{q}\)</span> i <span class="math inline">\(Y \in \mathbb{R}^{p}\)</span>,</li>
<li>
<span class="math inline">\(\Sigma_{XX}\)</span> i <span class="math inline">\(\Sigma_{YY}\)</span> to macierze kowariancji odpowiednio <span class="math inline">\(q \times q\)</span> i <span class="math inline">\(p \times p\)</span>,</li>
<li>
<span class="math inline">\(\Sigma_{XY}=\Sigma_{YX}^\top\)</span> to macierz kowariancji miÄ™dzy <span class="math inline">\(X\)</span> i <span class="math inline">\(Y\)</span>.</li>
</ul>
<p>Szukamy wektorÃ³w <span class="math inline">\(a \in \mathbb{R}^q\)</span>, <span class="math inline">\(b \in \mathbb{R}^p\)</span>, ktÃ³re <strong>maksymalizujÄ… korelacjÄ™</strong> pomiÄ™dzy kombinacjami liniowymi <span class="math display">\[
U=a^\top X, \quad V=b^\top Y,
\]</span> czyli <span class="math display">\[
\rho(a,b)=\frac{a^\top \Sigma_{XY}b}{\sqrt{a^\top \Sigma_{XX}a},\sqrt{b^\top \Sigma_{YY}b}}.
\]</span></p>
<p>Pierwsza para kanoniczna <span class="math inline">\((a_1,b_1)\)</span> to para rozwiÄ…zujÄ…ca ten problem maksymalizacji. Kolejne pary <span class="math inline">\((a_k,b_k)\)</span> definiuje siÄ™ analogicznie, przy dodatkowych warunkach ortogonalnoÅ›ci wzglÄ™dem wczeÅ›niejszych par.</p>
</section><section id="dowÃ³d-istnienia-rozwiÄ…zania" class="level1 page-columns page-full"><h1>DowÃ³d istnienia rozwiÄ…zania</h1>
<section id="sformuÅ‚owanie-problemu-wÅ‚asnego" class="level2"><h2 class="anchored" data-anchor-id="sformuÅ‚owanie-problemu-wÅ‚asnego">SformuÅ‚owanie problemu wÅ‚asnego</h2>
<p>PrzeksztaÅ‚Ä‡my zmienne <span class="math display">\[
c=\Sigma_{XX}^{1/2}a,\quad d=\Sigma_{YY}^{1/2}b.
\]</span></p>
<p>WÃ³wczas <span class="math display">\[
\rho(a,b)=\frac{c^\top\Sigma_{XX}^{-1/2}\Sigma_{XY}\Sigma_{YY}^{-1/2}d}{\sqrt{c^\top c}\sqrt{d^\top d}}.
\]</span></p>
<p>Z lematu Cauchyâ€™egoâ€“Buniakowskiegoâ€“Schwarza mamy <span id="eq-cbs"><span class="math display">\[
\left|c^\top \mathbf{M} d\right| \le
\bigl(c^\top \mathbf{M}\mathbf{M}^\top c\bigr)^{1/2}\bigl(d^\top d\bigr)^{1/2},
\quad \text{gdzie }\mathbf{M}=\Sigma_{XX}^{-1/2}\Sigma_{XY}\Sigma_{YY}^{-1/2}.
\tag{5.1}\]</span></span></p>
<p>Zatem <span class="math display">\[
\rho(a,b)^2 \le
\frac{c^\top\mathbf{M}\mathbf{M}^\top c}{c^\top c}.
\]</span></p>
<p>PoniewaÅ¼ <span class="math inline">\(\mathbf{M}\mathbf{M}^\top=\Sigma_{XX}^{-1/2}\Sigma_{XY}\Sigma_{YY}^{-1}\Sigma_{YX}\Sigma_{XX}^{-1/2}\)</span> jest macierzÄ… symetrycznÄ… dodatnio okreÅ›lonÄ…, z lematu Rayleighaâ€“Ritza otrzymujemy <span class="math display">\[
\max_{c\neq 0}\frac{c^\top\mathbf{M}\mathbf{M}^\top c}{c^\top c}=\lambda_1,
\]</span> gdzie <span class="math inline">\(\lambda_1\)</span> to najwiÄ™ksza wartoÅ›Ä‡ wÅ‚asna tej macierzy, osiÄ…gana dla <span class="math inline">\(c=e_1\)</span> â€“ jej wektora wÅ‚asnego.</p>
<p>JeÅ›li <span class="math display">\[
d \propto \Sigma_{YY}^{-1/2}\Sigma_{YX}\Sigma_{XX}^{-1/2}e_1
\]</span> to <a href="#eq-cbs" class="quarto-xref">RÃ³wnanie&nbsp;<span>5.1</span></a> staje siÄ™ rÃ³wnoÅ›ciÄ….</p>
<p>WracajÄ…c do oryginalnych wspÃ³Å‚czynnikÃ³w <span class="math display">\[
a_1=\Sigma_{XX}^{-1/2}e_1,\quad
b_1\propto \Sigma_{YY}^{-1/2}\Sigma_{YX}\Sigma_{XX}^{-1/2}e_1.
\]</span></p>
<p>Pierwsza korelacja kanoniczna wynosi wÃ³wczas <span class="math display">\[
\rho_1=\sqrt{\lambda_1}.
\]</span></p>
<p>Analogicznie dla kolejnych par, przy zaÅ‚oÅ¼eniu <span class="math inline">\(c\perp e_1,\dots,e_{k-1}\)</span>, mamy <span class="math display">\[
\rho_k=\sqrt{\lambda_k},
\]</span> gdzie <span class="math inline">\(\lambda_k\)</span> to kolejne wartoÅ›ci wÅ‚asne macierzy <span class="math inline">\(\Sigma_{XX}^{-1/2}\Sigma_{XY}\Sigma_{YY}^{-1}\Sigma_{YX}\Sigma_{XX}^{-1/2}\)</span>, a odpowiadajÄ…ce im wektory wÅ‚asne <span class="math inline">\(e_k\)</span> definiujÄ… kolejne wektory kanoniczne <span class="math display">\[
U_k=e_k^\top\Sigma_{XX}^{-1/2}X,\quad
V_k=f_k^\top\Sigma_{YY}^{-1/2}Y,\quad
f_k\propto \Sigma_{YY}^{-1/2}\Sigma_{YX}\Sigma_{XX}^{-1/2}e_k.
\]</span></p>
</section><section id="wÅ‚asnoÅ›ci-rozwiÄ…zaÅ„" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="wÅ‚asnoÅ›ci-rozwiÄ…zaÅ„">WÅ‚asnoÅ›ci rozwiÄ…zaÅ„</h2>
<p>Dla kaÅ¼dej pary <span class="math inline">\((U_k,V_k)\)</span> zachodzi <span class="math display">\[
\mathrm{Var}(U_k)=\mathrm{Var}(V_k)=1,\quad
\mathrm{Cov}(U_k,U_l)=\mathrm{Cov}(V_k,V_l)=\mathrm{Cov}(U_k,V_l)=0\quad (k\neq l).
\]</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Adnotacja</span>DowÃ³d powyÅ¼szych rÃ³wnoÅ›ci
</div>
</div>
<div class="callout-body-container callout-body">
<p>Dla danej pary wektorÃ³w kanonicznych mamy</p>
<p><span class="math display">\[
U_k = a_k^\top X = e_k^\top \Sigma_{XX}^{-1/2} X,
    \qquad
    V_k = b_k^\top Y = f_k^\top \Sigma_{YY}^{-1/2} Y,
\]</span> gdzie:</p>
<ul>
<li>
<span class="math inline">\(e_k\)</span> jest ortonormalnym<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> wektorem wÅ‚asnym macierzy <span class="math inline">\(\Sigma_{XX}^{-1/2} \Sigma_{XY} \Sigma_{YY}^{-1} \Sigma_{YX} \Sigma_{XX}^{-1/2}\)</span>
</li>
<li>
<span class="math inline">\(f_k \propto \Sigma_{YY}^{-1/2} \Sigma_{YX} \Sigma_{XX}^{-1/2} e_k\)</span>,</li>
<li>
<span class="math inline">\(\rho_k = \sqrt{\lambda_k}\)</span>, gdzie <span class="math inline">\(\lambda_k\)</span> to odpowiadajÄ…ca wartoÅ›Ä‡ wÅ‚asna.</li>
</ul>
<p>Macierze <span class="math inline">\(\Sigma_{XX}\)</span>, <span class="math inline">\(\Sigma_{YY}\)</span> sÄ… dodatnio okreÅ›lone, wiÄ™c moÅ¼na wprowadziÄ‡ transformacje <span class="math display">\[
\tilde{X} = \Sigma_{XX}^{-1/2}X, \quad \tilde{Y} = \Sigma_{YY}^{-1/2}Y.
\]</span> Zatem <span class="math display">\[
U_k = e_k^\top \tilde{X},\quad V_k = f_k^\top \tilde{Y}.
\]</span></p>
<p>Najpierw udowodnimy, Å¼e <span class="math inline">\(\operatorname{Var}(U_k) = \operatorname{Var}(V_k) = 1\)</span>.</p>
<p>Zmienna <span class="math inline">\(U_k = e_k^\top \tilde{X}\)</span>, wiÄ™c <span class="math display">\[
\operatorname{Var}(U_k) = \operatorname{Var}(e_k^\top \tilde{X}) = e_k^\top \operatorname{Var}(\tilde{X}) e_k.
\]</span> ZauwaÅ¼my, Å¼e <span class="math display">\[
\operatorname{Var}(\tilde{X}) = \Sigma_{XX}^{-1/2} \Sigma_{XX} \Sigma_{XX}^{-1/2} = I,
\]</span> wiÄ™c <span class="math display">\[
\operatorname{Var}(U_k) = e_k^\top I e_k = e_k^\top e_k = 1.
\]</span> Analogicznie <span class="math display">\[
\operatorname{Var}(V_k) = f_k^\top \operatorname{Var}(\tilde{Y}) f_k = f_k^\top f_k = 1,
\]</span> poniewaÅ¼ <span class="math inline">\(\tilde{Y}\)</span> ma jednostkowÄ… macierz kowariancji, a <span class="math inline">\(f_k\)</span> sÄ… znormalizowane.</p>
<p>Teraz dowiedziemy, Å¼e <span class="math inline">\(\operatorname{Cov}(U_k, U_l) = 0\)</span> dla <span class="math inline">\(k \neq l\)</span></p>
<p><span class="math display">\[
\operatorname{Cov}(U_k, U_l) = \operatorname{Cov}(e_k^\top \tilde{X}, e_l^\top \tilde{X}) = e_k^\top \operatorname{Var}(\tilde{X}) e_l = e_k^\top e_l.
\]</span> PoniewaÅ¼ <span class="math inline">\(e_k\)</span>, <span class="math inline">\(e_l\)</span> sÄ… ortonormalnymi wektorami wÅ‚asnymi symetrycznej macierzy, to <span class="math display">\[
e_k^\top e_l = 0 \quad \text{dla } k \neq l.
\]</span> Zatem <span class="math display">\[
\operatorname{Cov}(U_k, U_l) = 0.
\]</span> Podobnie <span class="math display">\[
\operatorname{Cov}(V_k, V_l) = f_k^\top f_l = 0 \quad \text{dla } k \neq l.
\]</span></p>
<p>Na koniec dowiedÅºmy, Å¼e <span class="math inline">\(\operatorname{Cov}(U_k, V_l) = 0\)</span> dla <span class="math inline">\(k \neq l\)</span> <span class="math display">\[
\operatorname{Cov}(U_k, V_l) = \operatorname{Cov}(e_k^\top \tilde{X}, f_l^\top \tilde{Y}) = e_k^\top \operatorname{Cov}(\tilde{X}, \tilde{Y}) f_l.
\]</span> Z definicji <span class="math display">\[
\operatorname{Cov}(\tilde{X}, \tilde{Y}) = \Sigma_{XX}^{-1/2} \Sigma_{XY} \Sigma_{YY}^{-1/2} =: M.
\]</span> Zatem <span class="math display">\[
\operatorname{Cov}(U_k, V_l) = e_k^\top M f_l.
\]</span> Z poprzednich wyprowadzeÅ„ <span class="math display">\[
f_l \propto M^\top e_l.
\]</span> Zatem <span class="math display">\[
\operatorname{Cov}(U_k, V_l) \propto e_k^\top M M^\top e_l.
\]</span> Ale macierz <span class="math inline">\(MM^\top\)</span> jest symetryczna, a <span class="math inline">\(e_k\)</span> sÄ… jej ortonormalnymi wektorami wÅ‚asnymi, wiÄ™c <span class="math display">\[
e_k^\top MM^\top e_l = 0 \quad \text{dla } k \neq l.
\]</span> Zatem <span class="math display">\[
\operatorname{Cov}(U_k, V_l) = 0.
\]</span></p>
</div>
</div>
<div class="no-row-height column-margin column-container"><div id="fn6"><p><sup>6</sup>&nbsp;ortonormalnoÅ›Ä‡ wynika z niezmienniczoÅ›ci korelacji wzglÄ™dem dÅ‚ugoÅ›ci wektorÃ³w</p></div></div><p>Ponadto korelacje kanoniczne sÄ… niezmiennicze wzglÄ™dem odwracalnych przeksztaÅ‚ceÅ„ liniowych <span class="math inline">\(X\)</span> i <span class="math inline">\(Y\)</span>: <span class="math display">\[
X^*=\mathcal{U}^TX+u,\quad Y^*=\mathcal{V}^TY+v \implies
\rho_i(X^*,Y^*)=\rho_i(X,Y).
\]</span></p>
</section></section><section id="testowanie-liczby-istotnych-korelacji-kanonicznych" class="level1"><h1>Testowanie liczby istotnych korelacji kanonicznych</h1>
<p>W kontekÅ›cie analizy kanonicznej (CCA), istotnym zagadnieniem jest testowanie liczby istotnych korelacji kanonicznych. Celem jest ustalenie, ile par zmiennych kanonicznych (kombinacji liniowych zmiennych z dwÃ³ch zbiorÃ³w <span class="math inline">\(X\)</span> i <span class="math inline">\(Y\)</span>) jest statystycznie istotnie skorelowanych. W tym celu stosuje siÄ™ testy statystyczne, ktÃ³re pozwalajÄ… odrzuciÄ‡ hipotezÄ™ zerowÄ… o braku skorelowania miÄ™dzy zbiorami zmiennych.</p>
<section id="hipoteza-zerowa-i-alternatywna" class="level2"><h2 class="anchored" data-anchor-id="hipoteza-zerowa-i-alternatywna">Hipoteza zerowa i alternatywna</h2>
<p>Dla zbiorÃ³w zmiennych <span class="math inline">\(X \in \mathbb{R}^p\)</span>, <span class="math inline">\(Y \in \mathbb{R}^q\)</span>, testujemy</p>
<ul>
<li>
<span class="math inline">\(H_0: \rho_1 = \rho_2 = \cdots = \rho_s = 0\)</span> â€“ brak istotnych korelacji kanonicznych (pierwiastkÃ³w),</li>
<li>
<span class="math inline">\(H_1\)</span>: istnieje co najmniej jedna istotna korelacja kanoniczna, tj. <span class="math inline">\(\exists i \leq s \ \text{takie, Å¼e } \rho_i \ne 0\)</span>.</li>
</ul>
<p>gdzie <span class="math inline">\(s = \min(p, q)\)</span>, a <span class="math inline">\(\rho_i\)</span> to <span class="math inline">\(i\)</span>-ta korelacja kanoniczna.</p>
</section><section id="statystyka-testowa-test-wilka" class="level2"><h2 class="anchored" data-anchor-id="statystyka-testowa-test-wilka">Statystyka testowa â€“ test Wilka</h2>
<p>W celu przetestowania tej hipotezy, wykorzystuje siÄ™ statystykÄ™ Wilka, ktÃ³ra bazuje na iloczynie skÅ‚adnikÃ³w postaci (<span class="math inline">\(1 - \lambda_i\)</span>), gdzie <span class="math inline">\(\lambda_i\)</span> to wartoÅ›ci wÅ‚asne odpowiadajÄ…ce kwadratom korelacji kanonicznych <span class="math display">\[
\lambda_i = \rho_i^2.
\]</span> Statystyka Wilkas jest zdefiniowana jako <span class="math display">\[
\Lambda = \prod_{i=1}^s (1 - \lambda_i).
\]</span></p>
<p>Interpretacja - im mniejsze wartoÅ›ci <span class="math inline">\(\Lambda\)</span>, tym wiÄ™ksza zaleÅ¼noÅ›Ä‡ miÄ™dzy zbiorami <span class="math inline">\(X\)</span> i <span class="math inline">\(Y\)</span>. DuÅ¼e wartoÅ›ci <span class="math inline">\(\lambda_i\)</span> (czyli silne korelacje kanoniczne) powodujÄ…, Å¼e <span class="math inline">\(\Lambda\)</span> dÄ…Å¼y do zera.</p>
<p>W praktyce, dla prÃ³by <span class="math inline">\(n\)</span>-elementowej, stosujemy wersjÄ™ testu bazujÄ…cÄ… na macierzach kowariancji estymowanych z prÃ³by <span class="math inline">\(S_{XX}, S_{XY}, S_{YX}, S_{YY})\)</span> â€“ odpowiedniki <span class="math inline">\(\Sigma_{XX}, \Sigma_{XY}, \Sigma_{YX}, \Sigma_{YY}\)</span>.</p>
<p>WÃ³wczas <span class="math display">\[
T^2/n = \left|I - S_{YY}^{-1} S_{YX} S_{XX}^{-1} S_{XY} \right| = \prod_{i=1}^s (1 - \hat{\lambda}_i),
\]</span> gdzie <span class="math inline">\(\hat{\lambda}_i\)</span> to <em>prÃ³bkowe wartoÅ›ci wÅ‚asne</em> (szacunki <span class="math inline">\(\lambda_i\)</span>).</p>
</section><section id="rozkÅ‚ad-asymptotyczny-i-transformacja-do-rozkÅ‚adu-chi2" class="level2"><h2 class="anchored" data-anchor-id="rozkÅ‚ad-asymptotyczny-i-transformacja-do-rozkÅ‚adu-chi2">RozkÅ‚ad asymptotyczny i transformacja do rozkÅ‚adu <span class="math inline">\(\chi^2\)</span>
</h2>
<p>Wielu autorÃ³w (np. <span class="citation" data-cites="marriott1986">Marriott i Gittins (<a href="references.html#ref-marriott1986" role="doc-biblioref">1986</a>)</span>) sugeruje przeksztaÅ‚cenie statystyki Wilksa do postaci asymptotycznie zgodnej z rozkÅ‚adem <span class="math inline">\(\chi^2\)</span>, np. za pomocÄ… transformacji</p>
<p><span class="math display">\[
-\left(n - \frac{1}{2}(p + q + 1) \right) \cdot \ln(\Lambda) \sim \chi^2_{pq}.
\]</span></p>
</section><section id="procedura-testowania" class="level2"><h2 class="anchored" data-anchor-id="procedura-testowania">Procedura testowania</h2>
<ol type="1">
<li>Oszacuj wszystkie korelacje kanoniczne <span class="math inline">\(\hat{\rho}_1, \ldots, \hat{\rho}_p\)</span>.</li>
<li>Od <span class="math inline">\(k = 0\)</span> do <span class="math inline">\(p-1\)</span> oblicz <span class="math inline">\(\Lambda_k = \prod_{i=k+1}^{p}(1 - \hat{\rho}_i^2)\)</span>.</li>
<li>Oblicz transformacjÄ™ <span class="math inline">\(\chi^2_k=-\left(n - \frac{1}{2}(p + q + 1) \right) \cdot \ln(\Lambda_k)\)</span>
</li>
<li>PorÃ³wnaj z odpowiednim kwantylem rozkÅ‚adu <span class="math inline">\(\chi^2\)</span> z <span class="math inline">\((q - k)(r - k)\)</span> stopniami swobody.</li>
<li>JeÅ›li wartoÅ›Ä‡ statystyki przekracza ten kwantyl (<span class="math inline">\(p&lt;\alpha\)</span>), odrzuÄ‡ <span class="math inline">\(H_0^{(k)}\)</span> i przejdÅº do <span class="math inline">\(k+1\)</span>. JeÅ›li nie, zatrzymaj siÄ™ â€“ kolejne korelacje uznajemy za nieistotne.</li>
</ol>
<p>Ocena dopasowania modelu w analizie kanonicznej (CCA â€“ <em>Canonical Correlation Analysis</em>) obejmuje kilka istotnych wskaÅºnikÃ³w diagnostycznych, ktÃ³re pozwalajÄ… zrozumieÄ‡ siÅ‚Ä™ i strukturÄ™ relacji miÄ™dzy dwoma zbiorami zmiennych. PoniÅ¼ej omÃ³wione zostaÅ‚y trzy kluczowe miary: Å‚adunki czynnikowe, wariancja wyjaÅ›niona oraz redundancja.</p>
</section></section><section id="ocena-dopasowania-modelu" class="level1"><h1>Ocena dopasowania modelu</h1>
<section id="Å‚adunki-czynnikowe-ang.-canonical-loadings" class="level2"><h2 class="anchored" data-anchor-id="Å‚adunki-czynnikowe-ang.-canonical-loadings">Åadunki czynnikowe (ang. <em>canonical loadings</em>)</h2>
<ul>
<li>
<strong>Definicja</strong> - korelacje pomiÄ™dzy zmiennymi kanonicznymi (czyli kombinacjami liniowymi wektorÃ³w <span class="math inline">\(a_k'X\)</span> i <span class="math inline">\(b_k'Y\)</span>) a oryginalnymi zmiennymi ze zbiorÃ³w <span class="math inline">\(X\)</span> i <span class="math inline">\(Y\)</span>.</li>
<li>
<strong>Interpretacja</strong>:
<ul>
<li>PokazujÄ…, ktÃ³re konkretne zmienne pierwotne w najwiÄ™kszym stopniu â€Å‚adujÄ… siÄ™â€ (czyli kontrybuujÄ…) na danÄ… zmiennÄ… kanonicznÄ….</li>
<li>Wysoka wartoÅ›Ä‡ (np. &gt; 0.7) wskazuje na silnÄ… zaleÅ¼noÅ›Ä‡ miÄ™dzy zmiennÄ… oryginalnÄ… a danÄ… zmiennÄ… kanonicznÄ….</li>
<li>Znaki dodatnie/ujemne pozwalajÄ… wnioskowaÄ‡ o kierunku zwiÄ…zku.</li>
</ul>
</li>
<li>
<strong>WzÃ³r</strong>:
<ul>
<li>Dla zbioru <span class="math inline">\(X\)</span>: <span class="math display">\[
\text{loadings}_X = \mathrm{Corr}(X, U_k) = \Sigma_{XX} a_k
\]</span>
</li>
<li>Dla zbioru <span class="math inline">\(Y\)</span>: <span class="math display">\[
\text{loadings}_Y = \mathrm{Corr}(Y, V_k) = \Sigma_{YY} b_k
\]</span>
</li>
</ul>
</li>
</ul></section><section id="wariancja-wyjaÅ›niona-ang.-variance-explained" class="level2"><h2 class="anchored" data-anchor-id="wariancja-wyjaÅ›niona-ang.-variance-explained">Wariancja wyjaÅ›niona (ang. <em>variance explained</em>)</h2>
<ul>
<li>
<strong>Definicja</strong> - Å›rednia kwadratÃ³w Å‚adunkÃ³w czynnikowych dla kaÅ¼dej zmiennej kanonicznej i kaÅ¼dego zbioru danych.</li>
<li>
<strong>Interpretacja</strong>:
<ul>
<li>Informuje, jakÄ… czÄ™Å›Ä‡ wariancji oryginalnych zmiennych w danym zbiorze (<span class="math inline">\(X\)</span> lub <span class="math inline">\(Y\)</span>) wyjaÅ›nia dana zmienna kanoniczna.</li>
<li>MoÅ¼na traktowaÄ‡ ten wskaÅºnik jako odpowiednik wspÃ³Å‚czynnika determinacji <span class="math inline">\(R^2\)</span> dla pojedynczej zmiennej kanonicznej.</li>
<li>Wysoka wartoÅ›Ä‡ oznacza, Å¼e dana zmienna kanoniczna dobrze reprezentuje zbiÃ³r, z ktÃ³rego zostaÅ‚a utworzona.</li>
</ul>
</li>
<li>
<strong>WzÃ³r</strong>: <span class="math display">\[
\text{Explained variance} = \frac{1}{p} \sum_{j=1}^{p} \mathrm{Corr}^2(X_j, U_k)
\]</span> gdzie <span class="math inline">\(p\)</span> to liczba zmiennych w zbiorze <span class="math inline">\(X\)</span>, a <span class="math inline">\(U_k\)</span> to <span class="math inline">\(k\)</span>-ta zmienna kanoniczna.</li>
</ul></section><section id="redundancja-ang.-redundancy-index" class="level2"><h2 class="anchored" data-anchor-id="redundancja-ang.-redundancy-index">Redundancja (ang. <em>redundancy index</em>)</h2>
<ul>
<li>
<strong>Definicja</strong> - iloczyn kwadratu korelacji kanonicznej <span class="math inline">\(\rho_k^2\)</span> oraz wariancji wyjaÅ›nionej przez danÄ… zmiennÄ… kanonicznÄ… we wÅ‚asnym zbiorze.</li>
<li>
<strong>Interpretacja</strong>:
<ul>
<li>Informuje, jaka czÄ™Å›Ä‡ przeciÄ™tnej wariancji jednej grupy zmiennych jest wyjaÅ›niana przez zmiennÄ… kanonicznÄ… utworzonÄ… na podstawie drugiego zbioru.</li>
<li>Miara ta pokazuje, czy dany zbiÃ³r zmiennych wnosi unikalnÄ… informacjÄ™ o drugim zbiorze.</li>
<li>Wysoka redundancja oznacza, Å¼e istnieje istotny zwiÄ…zek miÄ™dzy strukturami dwÃ³ch zbiorÃ³w zmiennych.</li>
</ul>
</li>
<li>
<strong>WzÃ³r</strong>: <span class="math display">\[
\text{Redundancy}_X = \rho_k^2 \cdot \left( \frac{1}{p} \sum_{j=1}^{p} \mathrm{Corr}^2(X_j, U_k) \right)
\]</span> Analogicznie definiujemy redundancjÄ™ wzglÄ™dem <span class="math inline">\(Y\)</span>.</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 26%">
<col style="width: 39%">
<col style="width: 34%">
</colgroup>
<thead><tr class="header">
<th>Miara</th>
<th>Co opisuje</th>
<th>Interpretacja praktyczna</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Åadunki czynnikowe</td>
<td>SiÅ‚Ä™ powiÄ…zania zmiennej oryginalnej z kanonicznÄ…</td>
<td>Wysoka wartoÅ›Ä‡ â‡’ silna reprezentacja zmiennej</td>
</tr>
<tr class="even">
<td>Wariancja wyjaÅ›niona</td>
<td>Åšrednia siÅ‚a reprezentacji zbioru przez zm. kanonicznÄ…</td>
<td>Miara dopasowania struktury do zbioru</td>
</tr>
<tr class="odd">
<td>Redundancja</td>
<td>IloÅ›Ä‡ informacji o jednym zbiorze zawarta w drugim</td>
<td>Miara istotnoÅ›ci relacji miÄ™dzy zbiorami</td>
</tr>
</tbody>
</table></section></section><section id="zaÅ‚oÅ¼enia-stosowalnoÅ›ci-analizy-kanonicznej" class="level1"><h1>ZaÅ‚oÅ¼enia stosowalnoÅ›ci analizy kanonicznej</h1>
<section id="normalnoÅ›Ä‡-wielowymiarowa" class="level2"><h2 class="anchored" data-anchor-id="normalnoÅ›Ä‡-wielowymiarowa">NormalnoÅ›Ä‡ wielowymiarowa</h2>
<p>ZakÅ‚ada siÄ™, Å¼e obydwa zbiory zmiennych losowych â€“ <span class="math inline">\(X\)</span> i <span class="math inline">\(Y\)</span> â€“ sÄ… wspÃ³lnie rozkÅ‚adem normalnym wielowymiarowym jak podano w <a href="#eq-normal" class="quarto-xref">RÃ³wnanie&nbsp;<span>4.1</span></a>. NormalnoÅ›Ä‡ umoÅ¼liwia stosowanie testÃ³w statystycznych (np. testu Wilksa) do oceny liczby istotnych korelacji kanonicznych.</p>
</section><section id="brak-wartoÅ›ci-odstajÄ…cych-outliers" class="level2"><h2 class="anchored" data-anchor-id="brak-wartoÅ›ci-odstajÄ…cych-outliers">Brak wartoÅ›ci odstajÄ…cych (outliers)</h2>
<p>ZarÃ³wno obserwacje odstajÄ…ce jednowymiarowe, jak i wielowymiarowe mogÄ… istotnie zaburzaÄ‡ wynik analizy kanonicznej. OdstajÄ…ce wartoÅ›ci mogÄ… wpÅ‚ywaÄ‡ na macierze kowariancji, zmieniajÄ…c kierunki i siÅ‚y relacji miÄ™dzy zbiorami zmiennych.</p>
</section><section id="wystarczajÄ…ca-liczba-obserwacji" class="level2"><h2 class="anchored" data-anchor-id="wystarczajÄ…ca-liczba-obserwacji">WystarczajÄ…ca liczba obserwacji</h2>
<p>Liczba obserwacji powinna znaczÄ…co przekraczaÄ‡ liczbÄ™ zmiennych w kaÅ¼dym zbiorze. Liczba obserwacji <span class="math inline">\(n\)</span> w kaÅ¼dej grupie powinna byÄ‡ wiÄ™ksza niÅ¼ suma liczby zmiennych w <span class="math inline">\(X\)</span> i <span class="math inline">\(Y\)</span> <span class="math display">\[
n &gt; p + q
\]</span> Zapewnia odwracalnoÅ›Ä‡ macierzy kowariancji oraz stabilnoÅ›Ä‡ estymatorÃ³w.</p>
</section><section id="liniowoÅ›Ä‡-zaleÅ¼noÅ›ci" class="level2"><h2 class="anchored" data-anchor-id="liniowoÅ›Ä‡-zaleÅ¼noÅ›ci">LiniowoÅ›Ä‡ zaleÅ¼noÅ›ci</h2>
<p>ZakÅ‚ada siÄ™, Å¼e zwiÄ…zki miÄ™dzy wszystkimi parami zmiennych sÄ… liniowe. PoniewaÅ¼ CCA opiera siÄ™ na maksymalizacji liniowych kombinacji, nieliniowe zaleÅ¼noÅ›ci mogÄ… pozostaÄ‡ niewykryte.</p>
</section><section id="brak-nadmiernej-wspÃ³Å‚liniowoÅ›ci-multikolinearnoÅ›ci" class="level2"><h2 class="anchored" data-anchor-id="brak-nadmiernej-wspÃ³Å‚liniowoÅ›ci-multikolinearnoÅ›ci">Brak nadmiernej wspÃ³Å‚liniowoÅ›ci (multikolinearnoÅ›ci)</h2>
<p>Zmienne wewnÄ…trz kaÅ¼dego zbioru (w <span class="math inline">\(X\)</span> lub w <span class="math inline">\(Y\)</span>) nie powinny byÄ‡ nadmiernie skorelowane. Wysoka wspÃ³Å‚liniowoÅ›Ä‡ moÅ¼e prowadziÄ‡ do niestabilnych i trudnych do interpretacji wektorÃ³w kanonicznych.</p>
</section><section id="niezaleÅ¼noÅ›Ä‡-obserwacji" class="level2"><h2 class="anchored" data-anchor-id="niezaleÅ¼noÅ›Ä‡-obserwacji">NiezaleÅ¼noÅ›Ä‡ obserwacji</h2>
<p>KaÅ¼da obserwacja powinna pochodziÄ‡ od innej jednostki (brak powtÃ³rzeÅ„ pomiarÃ³w). NiezaleÅ¼noÅ›Ä‡ warunkuje poprawnoÅ›Ä‡ estymatorÃ³w kowariancji.</p>
</section></section><section id="implementacje-cca-w-r" class="level1 page-columns page-full"><h1>Implementacje CCA w R</h1>
<p>Istnieje wiele bibliotek w jÄ™zyku R umoÅ¼liwiajÄ…cych wykonanie analizy kanonicznej. WÅ›rÃ³d najbardziej znanych sÄ…: <code>CCA::cc()</code>, <code><a href="https://rdrr.io/r/stats/cancor.html">stats::cancor()</a></code>), <code><a href="https://rdrr.io/pkg/yacca/man/cca.html">yacca::cca()</a></code> oraz w wersji regularyzowanej <code>mixOmics::rcc()</code>.</p>
<div class="exm-1 page-columns page-full">
<p>Oszacujemy zwiÄ…zek miÄ™dzy dwoma zestawami zmiennych w zbiorze <code>mtcars</code> przy uÅ¼yciu funkcji <code><a href="https://rdrr.io/pkg/yacca/man/cca.html">cca()</a></code> z pakietu <code>yacca</code>.</p>
<p>ZbiÃ³r <code>X</code> â€“ zmienne zwiÄ…zane z konstrukcjÄ… silnika i ukÅ‚adem napÄ™dowym:</p>
<ul>
<li>
<code>cyl</code> â€“ liczba cylindrÃ³w,</li>
<li>
<code>disp</code> â€“ pojemnoÅ›Ä‡ skokowa silnika,</li>
<li>
<code>hp</code> â€“ moc silnika,</li>
<li>
<code>drat</code> â€“ przeÅ‚oÅ¼enie tylnego mostu,</li>
<li>
<code>vs</code> â€“ ukÅ‚ad cylindrÃ³w.</li>
</ul>
<p>ZbiÃ³r <code>Y</code> â€“ zmienne zwiÄ…zane z osiÄ…gami i eksploatacjÄ…:</p>
<ul>
<li>
<code>mpg</code> â€“ zuÅ¼ycie paliwa,</li>
<li>
<code>qsec</code> â€“ czas przyspieszenia na odcinku 1/4 mili,</li>
<li>
<code>wt</code> â€“ masa pojazdu,</li>
<li>
<code>gear</code> â€“ liczba biegÃ³w,</li>
<li>
<code>am</code> â€“ typ skrzyni biegÃ³w (0 = automatyczna, 1 = manualna).</li>
</ul>
<div class="cell">
<details open="" class="code-fold"><summary>Kod</summary><div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">yacca</span><span class="op">)</span></span>
<span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="va">mtcars</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cyl"</span>, <span class="st">"disp"</span>, <span class="st">"hp"</span>, <span class="st">"drat"</span>, <span class="st">"vs"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">mtcars</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mpg"</span>, <span class="st">"qsec"</span>, <span class="st">"wt"</span>, <span class="st">"gear"</span>, <span class="st">"am"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/yacca/man/cca.html">cca</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, xcenter <span class="op">=</span> <span class="cn">T</span>, ycenter <span class="op">=</span> <span class="cn">T</span>, xscale <span class="op">=</span> <span class="cn">T</span>, yscale <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div><button title="Kopiuj do schowka" class="code-copy-button"><i class="bi"></i></button></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Canonical Correlation Analysis - Summary


Canonical Correlations:

     CV 1      CV 2      CV 3      CV 4      CV 5 
0.9665716 0.8528224 0.4950213 0.3882414 0.1145244 

Shared Variance on Each Canonical Variate:

      CV 1       CV 2       CV 3       CV 4       CV 5 
0.93426061 0.72730599 0.24504613 0.15073137 0.01311583 

Bartlett's Chi-Squared Test:

          rho^2      Chisq df    Pr(&gt;X)    
CV 1   0.934261 114.218145 25 2.286e-13 ***
CV 2   0.727306  44.805691 16 0.0001486 ***
CV 3   0.245046  11.670865  9 0.2325066    
CV 4   0.150731   4.502850  4 0.3422097    
CV 5   0.013116   0.336666  1 0.5617598    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1


Canonical Variate Coefficients:

    X Vars:
            CV 1       CV 2        CV 3       CV 4       CV 5
cyl  -0.35404018 -0.3202430  2.36562182 -0.2101579  2.1867041
disp -0.44058431 -0.9016099 -1.97209644  1.0904515  0.3808257
hp   -0.10170950  1.0627557 -0.66529863 -1.4565067 -0.5450210
drat  0.03729776  0.4100536 -0.20088591  0.6993630  1.4026658
vs    0.13910861 -0.6701374 -0.03612397 -1.0863066  1.2557431

    Y Vars:
            CV 1       CV 2       CV 3       CV 4       CV 5
mpg   0.01739764 -0.3425219 -0.6139144  1.6286135  1.8734129
qsec  0.56090973 -0.4612667 -0.5656445 -0.6828188 -0.9684395
wt   -0.56385903 -0.2021069 -1.7755574  1.1167115  0.6816007
gear  0.20081971  0.5205813 -0.6831098 -1.0936754  0.8817315
am    0.10680186  0.2747215 -0.5656426  0.8554364 -1.7866305


Structural Correlations (Loadings):

    X Vars:
           CV 1         CV 2       CV 3        CV 4       CV 5
cyl  -0.9750265  0.007506657  0.2027973 -0.04772071 0.07656948
disp -0.9657015 -0.165044027 -0.1961098  0.02389238 0.03392844
hp   -0.8622356  0.383602015 -0.1395992 -0.29730181 0.03902600
drat  0.7049027  0.502571435 -0.1734102  0.24734994 0.39910034
vs    0.8291339 -0.357899996 -0.1605599 -0.32947247 0.22385946

    Y Vars:
           CV 1        CV 2        CV 3       CV 4        CV 5
mpg   0.9019930  0.05452712  0.02246031  0.3616459  0.22834876
qsec  0.5994486 -0.74323004 -0.23715821 -0.1600776 -0.08001008
wt   -0.8680494 -0.31821554 -0.35390786 -0.1315301 -0.05175115
gear  0.5035786  0.79020784 -0.27115489 -0.1383502  0.17121455
am    0.5382387  0.72862313 -0.11673305  0.3475250 -0.21214903


Fractional Variance Deposition on Canonical Variates:

    X Vars:
          CV 1         CV 2       CV 3         CV 4        CV 5
cyl  0.9506768 5.634989e-05 0.04112674 0.0022772659 0.005862885
disp 0.9325794 2.723953e-02 0.03845905 0.0005708458 0.001151139
hp   0.7434502 1.471505e-01 0.01948793 0.0883883664 0.001523029
drat 0.4968878 2.525780e-01 0.03007110 0.0611819949 0.159281081
vs   0.6874630 1.280924e-01 0.02577947 0.1085521109 0.050113056

    Y Vars:
          CV 1        CV 2         CV 3       CV 4        CV 5
mpg  0.8135914 0.002973207 0.0005044654 0.13078775 0.052143158
qsec 0.3593386 0.552390895 0.0562440173 0.02562483 0.006401612
wt   0.7535098 0.101261132 0.1252507750 0.01730016 0.002678182
gear 0.2535914 0.624428427 0.0735249749 0.01914078 0.029314423
am   0.2897009 0.530891664 0.0136266038 0.12077364 0.045007211


Canonical Communalities (Fraction of Total Variance
Explained for Each Variable, Within Sets):

    X Vars:
 cyl disp   hp drat   vs 
   1    1    1    1    1 

    Y Vars:
 mpg qsec   wt gear   am 
   1    1    1    1    1 


Canonical Variate Adequacies (Fraction of Total Variance
Explained by Each CV, Within Sets):


    X Vars:
      CV 1       CV 2       CV 3       CV 4       CV 5 
0.76221142 0.11102337 0.03098486 0.05219412 0.04358624 

    Y Vars:
      CV 1       CV 2       CV 3       CV 4       CV 5 
0.49394642 0.36238906 0.05383017 0.06272543 0.02710892 


Redundancy Coefficients (Fraction of Total Variance
Explained by Each CV, Across Sets):


    X | Y:
        CV 1         CV 2         CV 3         CV 4         CV 5 
0.7121041066 0.0807479602 0.0075927195 0.0078672907 0.0005716698 

    Y | X:
       CV 1        CV 2        CV 3        CV 4        CV 5 
0.461474684 0.263567736 0.013190874 0.009454690 0.000355556 


Aggregate Redundancy Coefficients (Total Variance
Explained by All CVs, Across Sets):

    X | Y: 0.8088837 
    Y | X: 0.7480435 </code></pre>
</div>
</div>
<p>Teraz przeanalizujemy wyniki modelu. Zaczniemy od korelacji kanonicznych, ktÃ³re moÅ¼na wywoÅ‚aÄ‡ za pomocÄ… <code>model$corr</code>.</p>
<p>Wyniki analizy kanonicznej wskazujÄ…, Å¼e pierwsza zmienna kanoniczna (<code>CV 1</code>) charakteryzuje siÄ™ bardzo wysokÄ… korelacjÄ… kanonicznÄ…, rÃ³wnÄ… 0.967. Oznacza to, Å¼e istnieje silny zwiÄ…zek liniowy pomiÄ™dzy odpowiednimi kombinacjami liniowymi zmiennych ze zbiorÃ³w <span class="math inline">\(X\)</span> i <span class="math inline">\(Y\)</span>. Dodatkowo, wartoÅ›Ä‡ wspÃ³lnej wariancji dla tej zmiennej wynosi 93.4%, co oznacza, Å¼e ta pierwsza para zmiennych kanonicznych wyjaÅ›nia znacznÄ… czÄ™Å›Ä‡ wspÃ³Å‚zaleÅ¼noÅ›ci miÄ™dzy oboma zestawami zmiennych. Druga zmienna kanoniczna (<code>CV 2</code>) rÃ³wnieÅ¼ wykazuje silnÄ… korelacjÄ™, rÃ³wnÄ… 0.853, co sugeruje istnienie kolejnego istotnego zwiÄ…zku miÄ™dzy pozostaÅ‚ymi informacjami zawartymi w zbiorach <span class="math inline">\(X\)</span> i <span class="math inline">\(Y\)</span>. WspÃ³lna wariancja dla tej pary wynosi 72.7%, co wciÄ…Å¼ stanowi wysoki poziom wyjaÅ›nienia wspÃ³Å‚zmiennoÅ›ci.</p>
<p>Kolejne zmienne kanoniczne (<code>CV 3, CV 4, CV 5</code>) wykazujÄ… juÅ¼ znacznie sÅ‚absze korelacje kanoniczne â€“ odpowiednio 0.495, 0.388 i 0.115. Oznacza to, Å¼e siÅ‚a zaleÅ¼noÅ›ci miÄ™dzy dalszymi kombinacjami liniowymi zmiennych <span class="math inline">\(X\)</span> i <span class="math inline">\(Y\)</span> jest wyraÅºnie mniejsza. Co wiÄ™cej, wspÃ³lna wariancja spada (<code>model$corrsq</code>) dla tych par odpowiednio do 24.5%, 15.1% i jedynie 1.3%. Te wartoÅ›ci sugerujÄ…, Å¼e trzecia i kolejne zmienne kanoniczne mogÄ… mieÄ‡ ograniczonÄ… wartoÅ›Ä‡ interpretacyjnÄ… i potencjalnie moÅ¼na je pominÄ…Ä‡ w interpretacji, szczegÃ³lnie jeÅ›li wyniki testÃ³w istotnoÅ›ci (np. test Bartletta) nie potwierdzajÄ… ich znaczenia.</p>
<p>Wyniki testu chi-kwadrat Bartletta pozwalajÄ… oceniÄ‡, ktÃ³re pary zmiennych kanonicznych sÄ… statystycznie istotne, tzn. ktÃ³re z nich wyjaÅ›niajÄ… istotnÄ… czÄ™Å›Ä‡ wspÃ³Å‚zmiennoÅ›ci miÄ™dzy dwoma zbiorami zmiennych.</p>
<ul>
<li>Pierwsza kanoniczna korelacja (<code>CV 1</code>) jest wysoce istotna statystycznie, co potwierdza bardzo niski poziom istotnoÅ›ci <span class="math inline">\(p &lt; 2.3 \times 10^{-13}\)</span>. To oznacza, Å¼e pierwsza para zmiennych kanonicznych wyjaÅ›nia istotnÄ… czÄ™Å›Ä‡ zaleÅ¼noÅ›ci pomiÄ™dzy zbiorami <span class="math inline">\(X\)</span> i <span class="math inline">\(Y\)</span>.</li>
<li>Druga kanoniczna korelacja (<code>CV 2</code>) rÃ³wnieÅ¼ jest istotna, choÄ‡ nie tak silnie jak pierwsza. WartoÅ›Ä‡ statystyki wynosi 44.81 przy 16 stopniach swobody, a poziom istotnoÅ›ci to okoÅ‚o <span class="math inline">\(p = 0.00015\)</span>, co takÅ¼e pozwala na odrzucenie hipotezy zerowej o braku korelacji na tym poziomie.</li>
<li>Trzecia (<code>CV 3</code>), czwarta (<code>CV 4</code>) i piÄ…ta (<code>CV 5</code>) korelacje kanoniczne nie sÄ… istotne statystycznie. Ich wartoÅ›ci <span class="math inline">\(p\)</span>-value przekraczajÄ… standardowe poziomy istotnoÅ›ci (0.05), co oznacza brak wystarczajÄ…cych dowodÃ³w na to, Å¼e odpowiadajÄ…ce im kombinacje zmiennych <span class="math inline">\(X\)</span> i <span class="math inline">\(Y\)</span> sÄ… skorelowane w populacji.</li>
</ul>
<p>Na podstawie testu Bartletta moÅ¼na stwierdziÄ‡, Å¼e tylko pierwsze dwie kanoniczne pary zmiennych <span class="math inline">\((U_1, V_1)\)</span> i <span class="math inline">\((U_2, V_2)\)</span> sÄ… istotne statystycznie. Kolejne pary nie wnoszÄ… istotnej informacji o zaleÅ¼noÅ›ci miÄ™dzy zbiorami zmiennych i moÅ¼na je pominÄ…Ä‡ w interpretacji oraz dalszej analizie. Taki wniosek jest zgodny z wczeÅ›niejszÄ… ocenÄ… siÅ‚y korelacji kanonicznych oraz wspÃ³lnej wariancji.</p>
<p>Interpretacja wag kanonicznych (<em>canonical variate coefficients</em> - <code>model$xcoef</code> i <code>model$ycoef</code>) oraz Å‚adunkÃ³w strukturalnych (<em>structural correlations</em>, inaczej <em>loadings</em> - <code>model$xstructcorr</code> i <code>model$ystructcorr</code>) pozwala na peÅ‚ne zrozumienie, ktÃ³re zmienne pierwotne majÄ… najwiÄ™kszy wpÅ‚yw na poszczegÃ³lne zmienne kanoniczne oraz jak mocno sÄ… z nimi skorelowane. W interpretacji naleÅ¼y analizowaÄ‡ oba zestawy danych rÃ³wnoczeÅ›nie â€“ zarÃ³wno dla zmiennych <span class="math inline">\(X\)</span>, jak i <span class="math inline">\(Y\)</span>.</p>
<p><code>CV 1</code></p>
<ul>
<li>Dla zmiennych <span class="math inline">\(X\)</span>, najwiÄ™kszy wpÅ‚yw majÄ…: <code>disp</code> (â€“0.44), <code>cyl</code> (â€“0.35), <code>hp</code> (â€“0.10) â€“ czyli im wiÄ™ksza pojemnoÅ›Ä‡ i liczba cylindrÃ³w, tym niÅ¼sza wartoÅ›Ä‡ zmiennej kanonicznej <span class="math inline">\(U_1\)</span>.</li>
<li>Dla zmiennych <span class="math inline">\(Y\)</span>, najistotniejsze sÄ…: <code>wt</code> (â€“0.56), <code>qsec</code> (0.56), <code>gear</code> (0.20) â€“ wskazuje to, Å¼e <span class="math inline">\(V_1\)</span> roÅ›nie wraz z <code>qsec</code> i <code>gear</code>, a maleje przy wzroÅ›cie <code>wt</code>.</li>
</ul>
<p>JednoczeÅ›nie Å‚adunki strukturalne pokazujÄ…, jak silnie poszczegÃ³lne zmienne oryginalne sÄ… skorelowane z danÄ… zmiennÄ… kanonicznÄ…:</p>
<ul>
<li>Dla <span class="math inline">\(X\)</span>: <code>cyl</code> (â€“0.98), <code>disp</code> (â€“0.97), <code>hp</code> (â€“0.86), <code>vs</code> (0.83) â€“ bardzo silne powiÄ…zania ze zmiennymi opisujÄ…cymi silnik.</li>
<li>Dla <span class="math inline">\(Y\)</span>: <code>mpg</code> (0.90), <code>wt</code> (â€“0.87), <code>qsec</code> (0.60) â€“ sugeruje, Å¼e pierwsza zmienna kanoniczna opisuje zwiÄ…zek miÄ™dzy cechami silnika a zuÅ¼yciem paliwa i masÄ… pojazdu.</li>
</ul>
<p><code>CV 1</code> wskazuje na silnÄ… zaleÅ¼noÅ›Ä‡ miÄ™dzy masÄ… i mocÄ… samochodu (cechy techniczne) a jego ekonomiÄ… (<code>mpg</code>) i osiÄ…gami (<code>qsec</code>). WiÄ™ksze silniki sÄ… zwiÄ…zane z wiÄ™kszÄ… masÄ… i spalaniem (niÅ¼szym <code>mpg</code>).</p>
<p><code>CV 2</code></p>
<ul>
<li>Dla <span class="math inline">\(X\)</span>: <code>disp</code> (â€“0.90), <code>hp</code> (1.06), <code>drat</code> (0.41), <code>vs</code> (â€“0.67) â€“ wskazuje na kontrast miÄ™dzy mocÄ… (<code>hp</code>) a objÄ™toÅ›ciÄ… i ukÅ‚adem silnika (<code>vs</code>).</li>
<li>Dla <span class="math inline">\(Y\)</span>: <code>gear</code> (0.52), <code>am</code> (0.27) â€“ wartoÅ›ci <code>CV 2</code> rosnÄ… przy wyÅ¼szej liczbie biegÃ³w i skrzyni manualnej.</li>
</ul>
<p>JednoczeÅ›nie Å‚adunki strukturalne pokazujÄ…, Å¼e</p>
<ul>
<li>
<span class="math inline">\(X\)</span>: <code>drat</code> (0.50), <code>hp</code> (0.38), <code>vs</code> (â€“0.36) â€“ umiarkowane korelacje.</li>
<li>
<span class="math inline">\(Y\)</span>: <code>gear</code> (0.79), <code>am</code> (0.73), <code>qsec</code> (â€“0.74) â€“ pokazuje powiÄ…zanie ze skrzyniÄ… biegÃ³w i czasem przyspieszenia.</li>
</ul>
<p><code>CV 2</code> odzwierciedla typ skrzyni biegÃ³w i dynamikÄ™ pojazdu. Samochody z wiÄ™kszÄ… liczbÄ… biegÃ³w i skrzyniÄ… manualnÄ… majÄ… inne cechy napÄ™du niÅ¼ te z automatem<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>.</p>
<div class="no-row-height column-margin column-container"><div id="fn7"><p><sup>7</sup>&nbsp;Wagi kanoniczne (<em>Canonical Variate Coefficients</em>) pokazujÄ…, jak zmienne pierwotne sÄ… <strong>waÅ¼one w kombinacji liniowej</strong> tworzÄ…cej zmiennÄ… kanonicznÄ…. Oznacza to, Å¼e dana zmienna ma okreÅ›lonÄ… kontrybucjÄ™ do wyniku przy jednoczesnym uwzglÄ™dnieniu obecnoÅ›ci wszystkich pozostaÅ‚ych zmiennych w modelu. Innymi sÅ‚owy, wagi sÄ… wynikiem rozwiÄ…zania problemu optymalizacji, w ktÃ³rym maksymalizujemy korelacjÄ™ miÄ™dzy dwiema kombinacjami liniowymi (<span class="math inline">\(a'X\)</span> i <span class="math inline">\(b'Y\)</span>), i odzwierciedlajÄ… wzglÄ™dny wpÅ‚yw danej zmiennej <strong>w kontekÅ›cie wspÃ³Å‚dziaÅ‚ania z innymi zmiennymi</strong>. Åadunki kanoniczne (<em>loadings</em>) natomiast opisujÄ… zwykÅ‚Ä… korelacjÄ™ miÄ™dzy zmiennÄ… kanonicznÄ… a kaÅ¼dÄ… pojedynczÄ… zmiennÄ… oryginalnÄ…, czyli <strong>bez kontroli pozostaÅ‚ych zmiennych</strong>. W tym sensie sÄ… one bliÅ¼sze klasycznej interpretacji wspÃ³Å‚czynnikÃ³w korelacji, ktÃ³re pokazujÄ…, jak silnie dana zmienna jest â€powiÄ…zanaâ€ z kanonicznym wymiarem, ale juÅ¼ nie informujÄ…, jaka byÅ‚a jej rzeczywista kontrybucja do utworzenia kombinacji liniowej. Dlatego moÅ¼liwe sÄ… sytuacje, w ktÃ³rych zmienna ma niski wspÃ³Å‚czynnik wagowy (jej udziaÅ‚ w kombinacji jest maÅ‚y lub nawet ujemny), ale mimo to jej korelacja z uzyskanym wymiarem kanonicznym jest wysoka â€“ bo zmienna ta silnie podÄ…Å¼a za ogÃ³lnÄ… strukturÄ… zaleÅ¼noÅ›ci w zbiorze. To wÅ‚aÅ›nie obserwujemy w <code>CV 2</code>. Na przykÅ‚ad <code>disp</code> ma duÅ¼Ä… ujemnÄ… wagÄ™ (â€“0.90), co oznacza, Å¼e wnosi istotny wkÅ‚ad w kombinacjÄ™ liniowÄ… <span class="math inline">\(U_2\)</span>, ale jednoczeÅ›nie jej Å‚adunek jest tylko â€“0.17, czyli korelacja ze zmiennÄ… kanonicznÄ… jest umiarkowana (moÅ¼e siÄ™ zdarzyÄ‡, Å¼e bÄ™dzie nawet przeciwna). Oznacza to, Å¼e w obecnoÅ›ci innych zmiennych, szczegÃ³lnie takich jak <code>hp</code> czy <code>drat</code>, <code>disp</code> jest â€wymuszonyâ€ do peÅ‚nienia okreÅ›lonej roli w kombinacji liniowej, mimo Å¼e jego indywidualna korelacja z <span class="math inline">\(U_2\)</span> jest mniejsza.</p></div></div><p>InterpretacjÄ™ pozostaÅ‚ych par kanonicznych pominiÄ™to, ze wzgledu na brak istotnoÅ›ci statystycznej.</p>
<p>Interpretacja adekwatnoÅ›ci zmiennych kanonicznych (ang. <em>Canonical Variate Adequacies</em>) polega na ocenie, w jakim stopniu kaÅ¼da z kanonicznych zmiennych <span class="math inline">\(U_k\)</span> i <span class="math inline">\(V_k\)</span> wyjaÅ›nia wariancjÄ™ oryginalnych zmiennych w swoim zbiorze (odpowiednio: <span class="math inline">\(X\)</span> lub <span class="math inline">\(Y\)</span>). WskaÅºniki te sÄ… interpretowane jako miara â€reprezentatywnoÅ›ciâ€ danej zmiennej kanonicznej wzglÄ™dem zmiennych pierwotnych.</p>
<p><code>CV 1</code></p>
<p>Dla zbioru <span class="math inline">\(X\)</span>, pierwsza zmienna kanoniczna <span class="math inline">\(U_1\)</span> wyjaÅ›nia 76,2% caÅ‚kowitej wariancji zmiennych pierwotnych. Oznacza to, Å¼e kombinacja liniowa <span class="math inline">\(U_1\)</span> bardzo dobrze reprezentuje gÅ‚Ã³wny wymiar zrÃ³Å¼nicowania zmiennych <span class="math inline">\(X\)</span> (np. liczby cylindrÃ³w, pojemnoÅ›ci silnika, mocy itd.). Wysoka adekwatnoÅ›Ä‡ wskazuje, Å¼e <span class="math inline">\(U_1\)</span> zawiera wiÄ™kszoÅ›Ä‡ informacji zawartej w zmiennych <span class="math inline">\(X\)</span>. Dla zbioru <span class="math inline">\(Y\)</span>, odpowiadajÄ…ca zmienna kanoniczna <span class="math inline">\(V_1\)</span> wyjaÅ›nia 49,4% wariancji zmiennych pierwotnych. Jest to rÃ³wnieÅ¼ stosunkowo wysoka wartoÅ›Ä‡, co oznacza, Å¼e <span class="math inline">\(V_1\)</span> dobrze streszcza informacje ze zbioru <span class="math inline">\(Y\)</span> (<code>mpg</code>, <code>qsec</code>, <code>wt</code>, <code>gear</code>, <code>am</code>). Zatem pierwsza para zmiennych kanonicznych <span class="math inline">\((U_1, V_1)\)</span> nie tylko ma bardzo wysokÄ… korelacjÄ™ wzajemnÄ…, ale rÃ³wnieÅ¼ silnie reprezentuje oba zbiory zmiennych, co czyni jÄ… interpretacyjnie bardzo istotnÄ….</p>
<p><code>CV 2</code></p>
<p>Dla zbioru <span class="math inline">\(X\)</span>, zmienna <span class="math inline">\(U_2\)</span> wyjaÅ›nia 11,1% wariancji. Jest to znacznie mniej niÅ¼ w przypadku <span class="math inline">\(U_1\)</span>, ale nadal moÅ¼e wskazywaÄ‡ na pewnÄ… drugorzÄ™dnÄ… strukturÄ™ w danych <span class="math inline">\(X\)</span>, np. kontrast miÄ™dzy rÃ³Å¼nymi cechami napÄ™du lub parametrÃ³w konstrukcyjnych pojazdu. Dla zbioru <span class="math inline">\(Y\)</span>, zmienna <span class="math inline">\(V_2\)</span> wyjaÅ›nia 36,2% wariancji, co stanowi wartoÅ›Ä‡ umiarkowanÄ…. MoÅ¼e to oznaczaÄ‡, Å¼e <span class="math inline">\(V_2\)</span> reprezentuje odrÄ™bny wymiar zrÃ³Å¼nicowania w danych <span class="math inline">\(Y\)</span>, byÄ‡ moÅ¼e zwiÄ…zany z typem skrzyni biegÃ³w lub przyspieszeniem. Druga para zmiennych kanonicznych tÅ‚umaczy mniejszÄ…, ale nadal znaczÄ…cÄ… czÄ™Å›Ä‡ zmiennoÅ›ci zmiennych pierwotnych, zwÅ‚aszcza po stronie <span class="math inline">\(Y\)</span>. MoÅ¼e wiÄ™c ujawniaÄ‡ dodatkowe, mniej oczywiste powiÄ…zania miÄ™dzy cechami konstrukcyjnymi a wÅ‚aÅ›ciwoÅ›ciami uÅ¼ytkowymi samochodÃ³w.</p>
<p>WskaÅºniki <em>redundancji kanonicznej</em> informujÄ… o tym, ile przeciÄ™tnej wariancji w jednym zbiorze zmiennych jest wyjaÅ›nione przez kombinacjÄ™ liniowÄ… zmiennych kanonicznych utworzonÄ… na podstawie drugiego zbioru. Jest to zatem miara uÅ¼ytecznoÅ›ci jednej grupy zmiennych do przewidywania drugiej, z uwzglÄ™dnieniem zarÃ³wno siÅ‚y korelacji kanonicznej, jak i struktury wariancji wewnÄ…trz zbiorÃ³w. Redundancja stanowi produkt odpowiedniego wspÃ³Å‚czynnika korelacji kanonicznej podniesionego do kwadratu i wspÃ³Å‚czynnika adekwatnoÅ›ci (czyli wyjaÅ›nionej wariancji).</p>
<p>Redundancja <span class="math inline">\(X|Y\)</span> okreÅ›la, jak dobrze zmienne kanoniczne ze zbioru <span class="math inline">\(Y\)</span> (czyli <span class="math inline">\(V_1, V_2, \ldots\)</span>) pozwalajÄ… wyjaÅ›niÄ‡ zmiennoÅ›Ä‡ w zbiorze <span class="math inline">\(X\)</span>.</p>
<ul>
<li>
<code>CV 1</code> - wartoÅ›Ä‡ 0.712 oznacza, Å¼e okoÅ‚o 71,2% wariancji zmiennych ze zbioru <span class="math inline">\(X\)</span> moÅ¼na wyjaÅ›niÄ‡ na podstawie pierwszej zmiennej kanonicznej <span class="math inline">\(V_1\)</span> (utworzonej ze zmiennych <span class="math inline">\(Y\)</span>). Jest to bardzo wysoka wartoÅ›Ä‡ i Å›wiadczy o duÅ¼ej nadmiarowoÅ›ci informacji miÄ™dzy zbiorami â€“ zmienne z <span class="math inline">\(Y\)</span> dobrze â€reprezentujÄ…â€ <span class="math inline">\(X\)</span>.</li>
<li>
<code>CV 2</code> - wartoÅ›Ä‡ 0.081 oznacza, Å¼e druga zmienna kanoniczna ze zbioru <span class="math inline">\(Y\)</span> wyjaÅ›nia juÅ¼ tylko 8,1% wariancji zbioru <span class="math inline">\(X\)</span>. To wyraÅºnie mniejszy wkÅ‚ad, ale moÅ¼e wciÄ…Å¼ wskazywaÄ‡ na drugorzÄ™dne zwiÄ…zki pomiÄ™dzy niektÃ³rymi zmiennymi w obu zbiorach.</li>
</ul>
<p>Redundancja <span class="math inline">\(Y|X\)</span> okreÅ›la, jak dobrze zmienne kanoniczne ze zbioru <span class="math inline">\(X\)</span> (czyli <span class="math inline">\(U_1, U_2, \ldots\)</span>) pozwalajÄ… wyjaÅ›niÄ‡ zmiennoÅ›Ä‡ w zbiorze <span class="math inline">\(Y\)</span>.</p>
<ul>
<li>
<code>CV 1</code> - wartoÅ›Ä‡ 0.461 oznacza, Å¼e pierwsza zmienna kanoniczna <span class="math inline">\(U_1\)</span> wyjaÅ›nia 46,1% wariancji zbioru <span class="math inline">\(Y\)</span>. To wynik dobry, choÄ‡ mniej spektakularny niÅ¼ w przypadku <span class="math inline">\(X | Y\)</span>, co moÅ¼e sugerowaÄ‡, Å¼e zbiÃ³r <span class="math inline">\(X\)</span> (cechy konstrukcyjne pojazdÃ³w) zawiera mniej informacji o cechach uÅ¼ytkowych i osiÄ…gach niÅ¼ odwrotnie.</li>
<li>
<code>CV 2</code> - wartoÅ›Ä‡ 0.264 oznacza, Å¼e druga zmienna kanoniczna <span class="math inline">\(U_2\)</span> wyjaÅ›nia 26,4% wariancji zmiennych w <span class="math inline">\(Y\)</span>. To umiarkowany wkÅ‚ad i Å›wiadczy o obecnoÅ›ci wyraÅºnej, ale sÅ‚abszej drugiej osi powiÄ…zaÅ„ miÄ™dzy zbiorami.</li>
</ul>
<p>Ponadto:</p>
<ul>
<li>CaÅ‚kowita redundancja <span class="math inline">\(X|Y = 0.809\)</span>, co oznacza, Å¼e zbiÃ³r <span class="math inline">\(Y\)</span> pozwala Å‚Ä…cznie wyjaÅ›niÄ‡ aÅ¼ 81% wariancji zmiennych z <span class="math inline">\(X\)</span> na podstawie wszystkich kanonicznych zmiennych <span class="math inline">\(V_k\)</span>.</li>
<li>CaÅ‚kowita redundancja <span class="math inline">\(Y|X = 0.748\)</span>, co oznacza, Å¼e zmienne z <span class="math inline">\(X\)</span> pozwalajÄ… wyjaÅ›niÄ‡ 75% wariancji w zbiorze <span class="math inline">\(Y\)</span>.</li>
</ul>
<p>Pierwsza para zmiennych kanonicznych jest zdecydowanie najistotniejsza, wyjaÅ›niajÄ…c wiÄ™kszoÅ›Ä‡ wspÃ³lnej struktury. Wysoka redundancja Å›wiadczy o silnym powiÄ…zaniu miÄ™dzy zbiorami zmiennych, szczegÃ³lnie miÄ™dzy konstrukcjÄ… pojazdu <span class="math inline">\(X\)</span> a jego osiÄ…gami i wyposaÅ¼eniem <span class="math inline">\(Y\)</span>. Druga zmienna kanoniczna wnosi mniej informacji, ale nadal ma interpretacyjnÄ… wartoÅ›Ä‡. PowyÅ¼ej drugiej pary, wartoÅ›ci stajÄ… siÄ™ bardzo niskie, co sugeruje, Å¼e kolejne zmienne kanoniczne nie dostarczajÄ… juÅ¼ istotnych zaleÅ¼noÅ›ci.</p>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-hotelling1936" class="csl-entry" role="listitem">
Hotelling, Harold. 1936. <span>â€Relations Between Two Sets of Variatesâ€</span>. <em>Biometrika</em> 28 (3/4): 321. <a href="https://doi.org/10.2307/2333955">https://doi.org/10.2307/2333955</a>.
</div>
<div id="ref-marriott1986" class="csl-entry" role="listitem">
Marriott, F. H. C., i R. Gittins. 1986. <span>â€Canonical Analysis: A Review with Applications in Ecology; Biomathematics, Vol. 12.â€</span> <em>Biometrics</em> 42 (1): 222. <a href="https://doi.org/10.2307/2531264">https://doi.org/10.2307/2531264</a>.
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Skopiowano!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Skopiowano!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./multi_tests.html" class="pagination-link" aria-label="Testy wielowymiarowe">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Testy wielowymiarowe</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./fa.html" class="pagination-link" aria-label="Analiza czynnikowa">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Analiza czynnikowa</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Wielowymiarowa analiza danych</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/DariuszMajerek/WAD_new/issues/new" class="toc-action"><i class="bi bi-github"></i>ZgÅ‚oÅ› problem</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Dariusz Majerek Â©2025</p>
</div>
  </div>
</footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>


</body></html>